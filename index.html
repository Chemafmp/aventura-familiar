const preguntas = [
  { pregunta: "¬øCu√°nto es 4 + 5?", respuesta: "9" },
  { pregunta: "¬øCu√°nto es 7 - 3?", respuesta: "4" },
  { pregunta: "¬øCu√°ntos d√≠as tiene una semana?", respuesta: "7" },
  { pregunta: "¬øCu√°nto es 2 x 3?", respuesta: "6" },
  { pregunta: "¬øCu√°ntas patas tiene un perro?", respuesta: "4" }
];

function mostrarEscena(escena) {
  const nodo = historia[escena];
  localStorage.setItem("escena", escena);
  document.getElementById("texto-historia").textContent = nodo.texto;
  const contenedorOpciones = document.getElementById("opciones");
  contenedorOpciones.innerHTML = "";

  nodo.opciones.forEach(op => {
    const btn = document.createElement("button");
    btn.textContent = op.texto;
    btn.onclick = () => {
      const pregunta = preguntas[Math.floor(Math.random() * preguntas.length)];
      const modal = document.getElementById("modal-acertijo");
      const input = document.getElementById("respuesta-acertijo");
      const textoPregunta = document.getElementById("pregunta-acertijo");
      const botonEnviar = document.getElementById("enviar-acertijo");

      textoPregunta.textContent = pregunta.pregunta;
      input.value = "";
      modal.classList.remove("hidden");

      botonEnviar.onclick = () => {
        const respuesta = input.value.trim();
        modal.classList.add("hidden");

        if (respuesta === pregunta.respuesta) {
          puntos += 10;
          localStorage.setItem("puntos", puntos);
          actualizarPuntosUI();
          agregarLogro("‚úÖ Acertijo resuelto");
          mostrarEscena(op.siguiente);
        } else {
          agregarLogro("‚ùå Acertijo fallado");
          mostrarEscena("fallo");
        }
      };
    };
    contenedorOpciones.appendChild(btn);
  });

  if (nodo.opciones.length === 0) {
    puntos += 50;
    localStorage.setItem("puntos", puntos);
    actualizarPuntosUI();
    agregarLogro("üèÅ Aventura completada");
  }
}

// Aseg√∫rate que en el objeto historia exista la escena "fallo" como esta:
// fallo: {
//   texto: "¬°Oh no! Fallaste el acertijo. Prueba otro camino.",
//   opciones: [
//     { texto: "Volver a la habitaci√≥n", siguiente: "inicio" }
//   ]
// }